var SGMPGlobal={};var jQuerySgmp=jQuery.noConflict();function sendShortcodeToEditor(a,b){window.location.href=a}function confirmShortcodeDelete(a,c){var b=confirm("Are you sure you want to delete shortcode\n'"+c+"' ?");if(b==true){window.location.href=a}}function displayShortcodeInPopup(a){(function(d){var e="#"+a;var c=buildShortcode(e,"TO_BE_GENERATED",d);var b="Upon saving, the shortcode will be available to you in post/page WYSIWYG editor -<br />just look for the map icon in the editor panel<br /><br /><div id='inner-shortcode-dialog'><b>"+c+"</b></div><br />";displayPopupWithContent(b,c,d)}(jQuerySgmp))}function displayPopupWithContent(g,c,f){var k=f('<div id="sgmp-popup-mask"/>');var b=Math.random().toString(36).substring(3);var d=f('<div id="'+b+'" class="sgmp-popup-shortcode-dialog sgmp-popup-window">');d.html("<div class='dismiss-container'><a class='dialog-dismiss' href='javascript:void(0)'>Ã—</a></div><p style='padding: 10px 10px 0 10px'>"+g+"</p><div align='center'><input type='button' class='save-dialog' value='Save' /></div>");f("body").append(k);f("body").append(d);var a=f(document).height();var i=f(window).width();f("#sgmp-popup-mask").css({width:i,height:a,opacity:0.1});if(f("#sgmp-popup-mask").length==1){f("#sgmp-popup-mask").show()}var e=f(window).height();var h=f(window).width();f("div#"+b).css("top",e/2-f("div#"+b).height()/2);f("div#"+b).css("left",h/2-f("div#"+b).width()/2);f("div#"+b).fadeIn(500);f(".sgmp-popup-window .save-dialog").click(function(l){var m=f("input#shortcode-title").val();if(typeof m==="undefined"||m.replace(/^\s+|\s+$/g,"")===""){m="Nameless"}m=m.replace(new RegExp("'","g"),"");f("input#hidden-shortcode-title").val(m);c=c.replace(new RegExp("'","g"),"");f("input#hidden-shortcode-code").val(c);f("form#shortcode-save-form").submit()});f(".sgmp-popup-window .dialog-dismiss").click(function(l){j(l,f(this))});function j(n,l){n.preventDefault();var m=f(l).closest("div.sgmp-popup-shortcode-dialog");if(m){f(m).remove()}if(f("div.sgmp-popup-shortcode-dialog").length==0){f("#sgmp-popup-mask").remove()}}f("#sgmp-popup-mask").click(function(){f(this).remove();f(".sgmp-popup-window").remove()});f(window).resize(function(){var n=f(".window");var m=f(document).height();var p=f(window).width();f("#sgmp-popup-mask").css({width:p,height:m});var o=f(window).height();var l=f(window).width();n.css("top",o/2-n.height()/2);n.css("left",l/2-n.width()/2)})}function muid(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)+""+Math.floor((1+Math.random())*65536).toString(16).substring(1)}function buildShortcode(e,a,c){var d={};var b='[google-map-v3 shortcodeid="'+a+'" ';c(e+" .shortcodeitem").each(function(){var h=c(this).attr("role");var g=c(this).val();if(h==="addmarkerlisthidden"){g=c("<div />").text(g).html();g=g.replace(new RegExp("'","g"),"");g=g.replace(new RegExp('"',"g"),"");g=g.replace(new RegExp("\\[|\\]","g"),"")}if(h==="styles"){g=g.replace(/\s+/g," ");g=base64_encode(g)}if(c(this).attr("type")==="checkbox"){g=c(this).is(":checked")}if(c(this).attr("type")==="radio"){var f=c(this).attr("name");g=c("input[name="+f+"]:checked").val();h=f}if(h===null||typeof h==="undefined"||h==="undefined"){h=c(this).attr("id")}if(h!==null&&h!==""&&g!==null&&g!==""){if(h.indexOf("_")>0){h=h.replace(/_/g,"")}if(h.indexOf("hidden")>0){h=h.replace(/hidden/g,"")}if(d[h]===null||typeof d[h]==="undefined"){d[h]=h;b+=h+'="'+g+'" '}}});b=b.replace(/^\s\s*/,"").replace(/\s\s*$/,"");b+="]";return b}(function(f){SGMPGlobal.sep=f("object#global-data-placeholder param#sep").val();if(SGMPGlobal.sep==null||SGMPGlobal.sep=="undefined"){SGMPGlobal.sep="{}"}SGMPGlobal.customMarkersUri=f("object#global-data-placeholder param#customMarkersUri").val();SGMPGlobal.defaultLocationText=f("object#global-data-placeholder param#defaultLocationText").val();SGMPGlobal.defaultBubbleText=f("object#global-data-placeholder param#defaultBubbleText").val();SGMPGlobal.assets=f("object#global-data-placeholder param#assets").val();SGMPGlobal.version=f("object#global-data-placeholder param#version").val();SGMPGlobal.shortcodes=f("object#global-data-placeholder param#shortcodes").val();SGMPGlobal.ajaxurl=f("object#global-data-placeholder param#ajaxurl").val();var o=[];function j(){o=[];var r="div.widget-google-map-container ul.token-input-list, div#google-map-container-metabox ul.token-input-list";f.map(f(r),function(v){var x=f(v).attr("id");if(x!=null&&x.indexOf("__i__")==-1){var w="#"+v.id+"hidden";var t=f(w).val();var u=f(v).tokenInput({holderId:x});if(t!=null&&t!=""){var s=t.split("|");f.map(s,function(y){u.add(y)})}o.push({id:x,obj:u})}})}function k(){f(document).on("focus","input.marker-text-details",function(){if(f(this).val().indexOf("Enter marker")!=-1){f(this).val("");f(this).removeClass("marker-input-info-text")}else{f(this).removeClass("marker-input-info-text")}});f(document).on("blur","input.marker-text-details",function(){var r=f(this).val().replace(/^\s+|\s+$/g,"");if(r==""){f(this).addClass("marker-input-info-text");if(f(this).attr("id").indexOf("bubble")==-1){f(this).val(SGMPGlobal.defaultLocationText)}else{f(this).val(SGMPGlobal.defaultBubbleText)}}})}function h(){f(document).on("click","input.add-additonal-location",function(s){var w=f(this).attr("id")+"list";var A={};f.map(f(o),function(C){if(C.id==w){A=C.obj;return}});var u="#"+f(this).attr("id")+"input";var v="#"+f(this).attr("id").replace("addmarker","locationaddmarkerinput");var t="#"+f(this).attr("id").replace("addmarker","bubbletextaddmarkerinput");var x=f(t).val();x=x.replace(/^\s+|\s+$/g,"");var z="#"+f(this).attr("id")+"icons";var r=f(z+" input[name='custom-icons-radio']:checked").val();if(f(v).val()!=null&&f(v).val()!=""&&f(v).val().indexOf("Enter marker")==-1){var y=f(v).val().replace(/^\s+|\s+$/g,"");var B=(y!==""&&y.length>1);if(B){x=SGMPGlobal.sep+x;if(x.indexOf("Enter marker")!=-1){x=""}y=y.replace(new RegExp("'","g"),"");x=x.replace(new RegExp("'","g"),"");x=x.replace(new RegExp('"',"g"),"");A.add(y+SGMPGlobal.sep+r+x);q(f(z));f(z+" img#default-marker-icon").attr("style","cursor: default; ");f(z+" img#default-marker-icon").addClass("selected-marker-image");f(z+" input#default-marker-icon-radio").prop("checked",true);f(u).attr("style","");f(u).addClass("default-marker-icon");f(v).val(SGMPGlobal.defaultLocationText);f(t).val(SGMPGlobal.defaultBubbleText);f(v).addClass("marker-input-info-text");f(t).addClass("marker-input-info-text")}else{i(v)}}else{i(v)}return false})}function i(r){f(r).fadeIn("slow",function(){f(this).addClass("errorToken")});f(r).fadeOut(function(){f(this).removeClass("errorToken");f(this).fadeIn("slow")})}function q(r){f.each(r.children(),function(){var s=f(this).find("img");if(s!=null){f(s).attr("style","");f(s).removeClass("selected-marker-image")}})}function d(){f(document).on("click","div.custom-icons-placeholder a img",function(){var r=f(this).attr("src");if(r!=null){var s=f(this).closest("div.custom-icons-placeholder");q(s);f(this).parent("a").siblings('input[name="custom-icons-radio"]').prop("checked",true);p(s,f(this))}});f(document).on("click","input[name='custom-icons-radio']",function(){var r=f(this).siblings("a").children("img");var s=f(r).attr("src");if(s!=null){var t=f(this).closest("div.custom-icons-placeholder");q(t);p(t,r)}})}function p(u,s){f(s).attr("style","cursor: default; ");f(s).addClass("selected-marker-image");var t=f(s).attr("src");var r=f(u).attr("id").replace("icons","input");f("#"+r).attr("style","background: url('"+t+"') no-repeat scroll 0px 0px transparent !important");f("#"+r).prop("readonly",true);f("#"+r).removeClass("default-marker-icon")}function n(){f(document).on("hover","a.google-map-tooltip-marker",function(){var r=f(this).attr("id");f("a#"+r+"[title]").tooltip({effect:"slide",opacity:0.8,tipClass:"google-map-tooltip",offset:[-5,0],events:{def:"click, mouseleave"}});f(document).on("mouseout","a#"+r,function(s){if(f(this).data("tooltip")){f(this).data("tooltip").hide()}})})}function c(){f(document).on("change","input.marker-geo-mashup",function(s){var u=f(this).attr("id");var t=u.replace("mashup","icons");var r=u.replace("addmarkermashup","kml");if(f(this).is(":checked")){f("#"+r).closest("fieldset").fadeOut();f("#"+t).closest("fieldset").fadeOut();f("#"+u+"hidden").val("true")}else{f("#"+r).closest("fieldset").fadeIn();f("#"+t).closest("fieldset").fadeIn();f("#"+u+"hidden").val("false")}})}function m(){var r="sgmp-find-posts-target";f(document).on("click","a.insert-shortcode-to-post",function(t){var s=f(this).attr("id");f("div.find-box-search input#affected").val(s);f("#find-posts").data(r,f(this));findPosts.open();f("#find-posts-submit").click(function(x){x.preventDefault();if(!f("#find-posts").data(r)){return}var w=f("#find-posts-response").find("input:checked");if(!w.length){return false}var u=w.val();var y=f("div.find-box-search input#_ajax_nonce").val();var v=f("div.find-box-search input#affected").val();f.post(SGMPGlobal.ajaxurl,{action:"sgmp_insert_shortcode_to_post_action",postId:u,shortcodeName:v},function(z){console.log("Posting selected post ID#"+u+" and shortcode name '"+v+"' to the server..");if(z!=null&&z.length>1){alert("Shortcode '"+v+"' was injected into post titled '"+z+"', ID#"+u);f("#find-posts-close").click()}})});f("#find-posts-close").click(function(){f("#find-posts").removeData(r)})})}function e(){f.each(f("input.marker-geo-mashup"),function(){var u=f(this).attr("id");var s=f("#"+u+"hidden").val();var t=u.replace("mashup","icons");var r=u.replace("addmarkermashup","kml");if(s=="true"){f(this).attr("checked","checked");f("#"+r).closest("fieldset").hide();f("#"+t).closest("fieldset").hide()}else{f(this).removeAttr("checked");f("#"+r).closest("fieldset").show();f("#"+t).closest("fieldset").show()}})}function a(){f(document).on("change","input.gps-location-marker",function(r){var s=f(this).attr("id");if(f(this).is(":checked")){f("#"+s+"hidden").val("true")}else{f("#"+s+"hidden").val("false")}})}function l(){f.each(f("input.gps-location-marker"),function(){var s=f(this).attr("id");var r=f("#"+s+"hidden").val();if(r==="true"){f(this).prop("checked",true)}else{f(this).removeAttr("checked")}})}function g(){f(document).on("change","input.marker-clustering",function(r){var s=f(this).attr("id");if(f(this).is(":checked")){f("#"+s+"hidden").val("true")}else{f("#"+s+"hidden").val("false")}})}function b(){f.each(f("input.marker-clustering"),function(){var s=f(this).attr("id");var r=f("#"+s+"hidden").val();if(r==="true"){f(this).prop("checked",true)}else{f(this).removeAttr("checked")}})}f(document).ready(function(){j();h();k();n();d();l();b();a();e();c();g();m();if(typeof f("ul.tools-tabs-nav").tabs=="function"){f("ul.tools-tabs-nav").tabs("div.tools-tab-body",{tabs:"li",effect:"default"})}});f(document).ajaxSuccess(function(t,r,u){if(u!=null&&u.data!=null){var s=u.data.indexOf("id_base=slickgooglemap");if(s>0){j();l();e();b()}}})}(jQuerySgmp));function base64_encode(j){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var d,c,b,n,m,l,k,o,h=0,p=0,g="",f=[];if(!j){return j}do{d=j.charCodeAt(h++);c=j.charCodeAt(h++);b=j.charCodeAt(h++);o=d<<16|c<<8|b;n=o>>18&63;m=o>>12&63;l=o>>6&63;k=o&63;f[p++]=e.charAt(n)+e.charAt(m)+e.charAt(l)+e.charAt(k)}while(h<j.length);g=f.join("");var a=j.length%3;return(a?g.slice(0,a-3):g)+"===".slice(a||3)};