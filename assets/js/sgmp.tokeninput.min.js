var jQuerySgmp=jQuery.noConflict();(function(d){var a={};a.sep=d("object#global-data-placeholder param#sep").val();a.customMarkersUri=d("object#global-data-placeholder param#customMarkersUri").val();var c={holderId:null,theme:null,tokenDataId:"id",tokenDataValue:"value",tokenFormatter:function(g){var h=g[this.tokenDataValue];var i=h.split(a.sep);var j="<p style='padding-left: 50px'><i>No description provided</i> ..</p>";var f=i[2];if(i[0]!=null&&i[0]!==""){i[0]=i[0].replace(new RegExp("\\|","g")," - ")}if(f!=null&&f!==""){f=f.replace(new RegExp("\\[|\\]","g"),"");f=f.replace(new RegExp("\\|","g")," - ");j="<p style='padding-left: 50px'><i>"+f+"</i></p>"}return"<li><img src='"+a.customMarkersUri+i[1]+"' border='0' style='float: left; margin-right: 8px;'><p><b>"+i[0]+"</b></p>"+j+"</li>"}};var e={tokenList:"token-input-list",token:"token-input-token",inputToken:"token-input-input-token",highlightedToken:"token-input-highlighted-token",hidden:"marker-destinations",tokenDelete:"token-input-delete-token"};var b={init:function(f){var g=d.extend({},c,f||{});if(g.theme){g.classes={};d.each(e,function(h,i){g.classes[h]=i+"-"+g.theme})}else{g.classes=d.extend({},e)}return this.each(function(){d(this).data("tokenInputObject",new d.TokenList(this,g))})},clear:function(){this.data("tokenInputObject").clear();return this},add:function(f){this.data("tokenInputObject").add(f);return this},get:function(){return this.data("tokenInputObject").getTokens()}};d.fn.tokenInput=function(f){if(b[f]){return b[f].apply(this,Array.prototype.slice.call(arguments,1))}else{b.init.apply(this,arguments);return this.data("tokenInputObject")}};d.TokenList=function(m,g){var j=[];var m=d(m);var l=d("<li><p></p></li>").addClass(g.classes.inputToken);if(!m.has("li."+g.classes.token)){l.appendTo(m)}m.mouseover(function(o){var n=d(o.target).closest("li");if(n&&!n.hasClass(g.classes.inputToken)){n.addClass(g.classes.highlightedToken)}}).mouseout(function(o){var n=d(o.target).closest("li");if(n&&!n.hasClass(g.classes.inputToken)){n.removeClass(g.classes.highlightedToken)}});this.getTokens=function(){return j};this.add=function(n){f(n)};this.clear=function(){i()};function f(n){if(n!=null&&n!=""){n=n.replace(new RegExp("\\|","g")," - ");var q={id:(j.length+1),value:n};var p=false;m.children().each(function(){var s=d(this);var r=d.data(s.get(0),"tokeninput");if(r&&r.value===q.value){p=true}});if(!p){m.css("border","1px solid #C9C9C9");l.remove();j.push(q);var o=d(g.tokenFormatter(q));o=d(o).addClass(g.classes.token).appendTo(m);d.data(o.get(0),"tokeninput",q);d("<span></span>").addClass(g.classes.tokenDelete).addClass("uiCloseButton").appendTo(o).click(function(){h(d(this).parent());if(!(m.children().size()>0)){l.appendTo(m);m.css("border","")}return false});k()}}}function i(){m.children("li").each(function(){h(d(this))});l.appendTo(m)}function h(o){var p=d.data(o.get(0),"tokeninput");var n=o.prevAll().length;o.remove();j=j.slice(0,n).concat(j.slice(n+1));k()}function k(){var n=d.map(j,function(o){return o[g.tokenDataValue]});jQuerySgmp("#"+g.holderId+"hidden").val((n.join("|")))}}}(jQuerySgmp));